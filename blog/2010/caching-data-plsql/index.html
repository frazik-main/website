<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Caching Static Data in PL/SQL for Performance Improvement | Frazik </title> <meta name="author" content="Frazik Content Knitting and Lead Alchemy"> <meta name="description" content="Optimize PL/SQL performance by caching static data in a collection stored in the session's PGA."> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/website/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/website/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/website/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/website/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/website/assets/img/data_array.svg?a67830f68c3523b294fc45d8e9b8773d"> <link rel="stylesheet" href="/website/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://frazik-main.github.io/website/blog/2010/caching-data-plsql/"> <script src="/website/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/website/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/website/"> Frazik </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/website/">about </a> </li> <li class="nav-item active"> <a class="nav-link" href="/website/blog/">blog </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Caching Static Data in PL/SQL for Performance Improvement</h1> <p class="post-meta"> Created in September 03, 2010 </p> <p class="post-tags"> <a href="/website/blog/2010"> <i class="fa-solid fa-calendar fa-sm"></i> 2010 </a>   ·   <a href="/website/blog/tag/plsql"> <i class="fa-solid fa-hashtag fa-sm"></i> plsql,</a>   <a href="/website/blog/tag/oracle"> <i class="fa-solid fa-hashtag fa-sm"></i> oracle,</a>   <a href="/website/blog/tag/performance"> <i class="fa-solid fa-hashtag fa-sm"></i> performance,</a>   <a href="/website/blog/tag/caching"> <i class="fa-solid fa-hashtag fa-sm"></i> caching,</a>   <a href="/website/blog/tag/collections"> <i class="fa-solid fa-hashtag fa-sm"></i> collections</a>   ·   <a href="/website/blog/category/database"> <i class="fa-solid fa-tag fa-sm"></i> database,</a>   <a href="/website/blog/category/performance-tuning"> <i class="fa-solid fa-tag fa-sm"></i> performance-tuning</a> </p> </header> <article class="post-content"> <div id="markdown-content"> <p>In many applications, PL/SQL programs repeatedly access the same data from a database. If this data is static (rarely or never changes), repeatedly querying it is inefficient. A better approach is to cache this data in a collection stored within the session’s PGA. This method uses the collection’s index as an “intelligent key,” retrieving data quickly without repeated database queries.</p> <p>Consider the following example:</p> <div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CREATE</span> <span class="k">OR</span> <span class="k">REPLACE</span> <span class="n">PACKAGE</span> <span class="n">onlyonce</span> <span class="k">AS</span>

    <span class="k">TYPE</span> <span class="n">names_t</span> <span class="k">IS</span>
        <span class="k">TABLE</span> <span class="k">OF</span> <span class="n">employees</span><span class="p">.</span><span class="n">first_name</span><span class="o">%</span><span class="k">TYPE</span>
            <span class="k">INDEX</span> <span class="k">BY</span> <span class="n">PLS_INTEGER</span><span class="p">;</span>

    <span class="k">names</span> <span class="n">names_t</span><span class="p">;</span>

    <span class="k">FUNCTION</span> <span class="n">get_name</span><span class="p">(</span><span class="n">employee_id_in</span> <span class="k">IN</span> <span class="n">employees</span><span class="p">.</span><span class="n">employee_id</span><span class="o">%</span><span class="k">TYPE</span><span class="p">)</span>
        <span class="k">RETURN</span> <span class="n">employees</span><span class="p">.</span><span class="n">first_name</span><span class="o">%</span><span class="k">TYPE</span><span class="p">;</span>

<span class="k">END</span> <span class="n">onlyonce</span><span class="p">;</span>
<span class="o">/</span>

<span class="k">CREATE</span> <span class="k">OR</span> <span class="k">REPLACE</span> <span class="n">PACKAGE</span> <span class="n">BODY</span> <span class="n">onlyonce</span> <span class="k">AS</span>

    <span class="k">FUNCTION</span> <span class="n">name_from_database</span><span class="p">(</span><span class="n">employee_id_in</span> <span class="k">IN</span> <span class="n">employees</span><span class="p">.</span><span class="n">employee_id</span><span class="o">%</span><span class="k">TYPE</span><span class="p">)</span>
        <span class="k">RETURN</span> <span class="n">employees</span><span class="p">.</span><span class="n">first_name</span><span class="o">%</span><span class="k">TYPE</span>
    <span class="k">IS</span>
        <span class="n">local_names</span> <span class="n">employees</span><span class="p">.</span><span class="n">first_name</span><span class="o">%</span><span class="k">TYPE</span><span class="p">;</span>
    <span class="k">BEGIN</span>
        <span class="k">SELECT</span> <span class="n">first_name</span>
            <span class="k">INTO</span> <span class="n">local_names</span>
            <span class="k">FROM</span> <span class="n">employees</span>
           <span class="k">WHERE</span> <span class="n">employee_id</span> <span class="o">=</span> <span class="n">employee_id_in</span><span class="p">;</span>
        <span class="k">RETURN</span> <span class="n">local_names</span><span class="p">;</span>
    <span class="n">EXCEPTION</span>
        <span class="k">WHEN</span> <span class="n">NO_DATA_FOUND</span> <span class="k">THEN</span>
            <span class="k">RETURN</span> <span class="k">NULL</span><span class="p">;</span> <span class="c1">-- Handle case where employee ID is not found</span>
    <span class="k">END</span><span class="p">;</span>

    <span class="k">FUNCTION</span> <span class="n">get_name</span><span class="p">(</span><span class="n">employee_id_in</span> <span class="k">IN</span> <span class="n">employees</span><span class="p">.</span><span class="n">employee_id</span><span class="o">%</span><span class="k">TYPE</span><span class="p">)</span>
        <span class="k">RETURN</span> <span class="n">employees</span><span class="p">.</span><span class="n">first_name</span><span class="o">%</span><span class="k">TYPE</span>
    <span class="k">IS</span>
        <span class="n">return_value</span> <span class="n">employees</span><span class="p">.</span><span class="n">first_name</span><span class="o">%</span><span class="k">TYPE</span><span class="p">;</span>
    <span class="k">BEGIN</span>
        <span class="k">RETURN</span> <span class="k">names</span><span class="p">(</span><span class="n">employee_id_in</span><span class="p">);</span>
    <span class="n">EXCEPTION</span>
        <span class="k">WHEN</span> <span class="n">NO_DATA_FOUND</span> <span class="k">THEN</span>
            <span class="k">names</span><span class="p">(</span><span class="n">employee_id_in</span><span class="p">)</span> <span class="p">:</span><span class="o">=</span> <span class="n">name_from_database</span><span class="p">(</span><span class="n">employee_id_in</span><span class="p">);</span>
            <span class="k">RETURN</span> <span class="k">names</span><span class="p">(</span><span class="n">employee_id_in</span><span class="p">);</span>
    <span class="k">END</span><span class="p">;</span>

<span class="k">END</span> <span class="n">onlyonce</span><span class="p">;</span>
<span class="o">/</span>

<span class="k">SET</span> <span class="n">SERVEROUTPUT</span> <span class="k">ON</span>

<span class="k">BEGIN</span>
    <span class="k">FOR</span> <span class="n">j</span> <span class="k">IN</span> <span class="mi">1</span><span class="p">..</span><span class="mi">10</span> <span class="n">LOOP</span>
        <span class="k">FOR</span> <span class="n">i</span> <span class="k">IN</span> <span class="mi">100</span><span class="p">..</span><span class="mi">150</span> <span class="n">LOOP</span>
            <span class="n">DBMS_OUTPUT</span><span class="p">.</span><span class="n">put_line</span><span class="p">(</span><span class="n">onlyonce</span><span class="p">.</span><span class="n">get_name</span><span class="p">(</span><span class="n">i</span><span class="p">));</span>
        <span class="k">END</span> <span class="n">LOOP</span><span class="p">;</span>
    <span class="k">END</span> <span class="n">LOOP</span><span class="p">;</span>
<span class="k">END</span><span class="p">;</span>
<span class="o">/</span>
</code></pre></div></div> <p>Let’s break down the code:</p> <p><strong>Lines 3-7:</strong> Declare a collection type (<code class="language-plaintext highlighter-rouge">names_t</code>) and a collection (<code class="language-plaintext highlighter-rouge">names</code>) to hold cached data.</p> <p><strong>Lines 16-26:</strong> <code class="language-plaintext highlighter-rouge">name_from_database</code> function retrieves data from the database one by one. Improved to handle <code class="language-plaintext highlighter-rouge">NO_DATA_FOUND</code> exception gracefully by returning <code class="language-plaintext highlighter-rouge">NULL</code>.</p> <p><strong>Line 28:</strong> Declaration of the main retrieval function (<code class="language-plaintext highlighter-rouge">get_name</code>). This function returns data either from the database or the collection, depending on whether the key exists in the collection. The only parameter is the employee ID.</p> <p><strong>Lines 32-40:</strong> The core caching logic. If an element with the given ID isn’t in the collection, it’s fetched from the database and added to the collection. The exception handling is improved to return <code class="language-plaintext highlighter-rouge">NULL</code> if the employee ID is not found in the database.</p> <p><strong>Lines 46-52:</strong> The code iterates through a range of employee IDs. The first iteration fetches data from the database; subsequent iterations retrieve data from the collection.</p> <p><strong>Performance Comparison:</strong> In testing, executing 10,000 queries against a table took approximately 2 seconds, while retrieving the same data from the collection took only 0.1 seconds�a significant performance improvement (an order of magnitude faster). Caching static data also improves code quality by implicitly documenting static structures within the program.</p> </div> </article> <br> <hr> <br> <ul class="list-disc pl-8"></ul> <h2 class="text-3xl font-semibold mb-4 mt-12">Enjoy Reading This Article?</h2> <p class="mb-2">Here are some more articles you might like to read next:</p> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/website/blog/2010/java-template-method-pattern/">Template Method Design Pattern in Java</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/website/blog/2010/java-strategy-design-pattern/">Strategy Pattern in Java</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/website/blog/2010/javascript-jquery-trigger/">Custom Events in jQuery - A Powerful Technique</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/website/blog/2010/dynamic-typing-plsql/">Using PL/SQL's ANY Types for Dynamic Typing</a> </li> <li class="my-2"> <a class="text-pink-700 underline font-semibold hover:text-pink-800" href="/website/blog/2010/plsq-cut-down-round-trips/">Using PL/SQL Collections to Optimize Data Retrieval</a> </li> </div> </div> <footer class="sticky-bottom mt-5" role="contentinfo"> <div class="container"> © Copyright 2025 Frazik Content Knitting and Lead Alchemy. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a>. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/website/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/website/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/website/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/website/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/website/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/website/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/website/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/website/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/website/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/website/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/website/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/website/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/website/assets/js/search-data.js"></script> <script src="/website/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>